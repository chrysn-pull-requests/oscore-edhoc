<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Using EDHOC for OSCORE with CoAP Transport</title>
<meta content="Francesca Palombini" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Hoeglund" name="author">
<meta content="Stefan Hristozov" name="author">
<meta content="Goeran Selander" name="author">
<meta content="
       This document defines how the lightweight authenticated key exchange protocol EDHOC is used for establishing an OSCORE Security Context, using CoAP for message transferring. Furthermore, this document defines an optimization approach for combining EDHOC run over CoAP with the first subsequent OSCORE transaction. This reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context. 
    " name="description">
<meta content="xml2rfc 3.7.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-oscore-edhoc-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.8.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 51.3.3
    six 1.15.0
-->
<link href="draft-ietf-core-oscore-edhoc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  scrollbar-color: #bbb #eee;
}
@media (prefers-color-scheme: dark) {
html {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
#title, #rfcnum {
  margin: 1.5em 0 0.2em;
}
#rfcnum + #title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EDHOC for OSCORE with CoAP Transport</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini, et al.</td>
<td class="center">Expires 18 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-oscore-edhoc-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-17" class="published">17 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-18">18 November 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. Hoeglund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">S. Hristozov</div>
<div class="org">Fraunhofer AISEC</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Using EDHOC for OSCORE with CoAP Transport</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines how the lightweight authenticated key exchange protocol EDHOC is used for establishing an OSCORE Security Context, using CoAP for message transferring. Furthermore, this document defines an optimization approach for combining EDHOC run over CoAP with the first subsequent OSCORE transaction. This reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Constrained RESTful Environments Working Group mailing list (core@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/core-wg/oscore-edhoc">https://github.com/core-wg/oscore-edhoc</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-edhoc-overview" class="xref">EDHOC Overview</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-transferring-edhoc-in-coap" class="xref">Transferring EDHOC in CoAP</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-deriving-an-oscore-security" class="xref">Deriving an OSCORE Security Context from EDHOC</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-edhoc-combined-with-oscore" class="xref">EDHOC Combined with OSCORE</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-edhoc-option" class="xref">EDHOC Option</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-client-processing" class="xref">Client Processing</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-server-processing" class="xref">Server Processing</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-example-of-edhoc-oscore-req" class="xref">Example of EDHOC + OSCORE Request</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-coap-option-numbers-registr" class="xref">CoAP Option Numbers Registry</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-edhoc-exporter-label-regist" class="xref">EDHOC Exporter Label Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-document-updates" class="xref">Document Updates</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-version-00-to-01" class="xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Ephemeral Diffie-Hellman Over COSE (EDHOC) <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> is a lightweight authenticated key exchange protocol, especially intended for use in constrained scenarios. As defined in Section 7.2 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, EDHOC messages can be transported over the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document builds on the EDHOC specification <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> and defines how EDHOC run over CoAP is used for establishing a Security Context for Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">In addition, this document defines an optimization approach that combines EDHOC run over CoAP with the first subsequent OSCORE transaction. This allows for a minimum number of round trips necessary to setup the OSCORE Security Context and complete an OSCORE transaction, for example, when an IoT device gets configured in a network for the first time.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This optimization is desirable, since the number of protocol round trips impacts the minimum number of flights, which in turn can have a substantial impact on the latency of conveying the first OSCORE request, when using certain radio technologies.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Without this optimization, it is not possible, not even in theory, to achieve the minimum number of flights. This optimization makes it possible also in practice since the last message of the EDHOC protocol can be made relatively small (see Section 1 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>), thus allowing additional OSCORE protected CoAP data within target MTU sizes.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The reader is expected to be familiar with terms and concepts defined in CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span>, CBOR sequences <span>[<a href="#RFC8742" class="xref">RFC8742</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and EDHOC <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-edhoc-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-edhoc-overview" class="section-name selfRef">EDHOC Overview</a>
      </h2>
<p id="section-2-1">The EDHOC protocol allows two peers to agree on a cryptographic secret, in a mutually-authenticated way and by using Diffie-Hellman ephemeral keys to achieve perfect forward secrecy. The two peers are denoted as Initiator and Responder, as the one sending or receiving the initial EDHOC message_1, respectively.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">After successful processing of EDHOC message_3, both peers agree on a cryptographic secret that can be used to derive further security material, and especially to establish an OSCORE Security Context <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>. The Responder can also send an optional EDHOC message_4 to achieve key confirmation, e.g. in deployments where no protected application message is sent from the Responder to the Initiator.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Section 7.2 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> specifies how to transport EDHOC over CoAP. That is, the EDHOC data (referred to as "EDHOC messages") are transported in the payload of CoAP requests and responses. The default message flow consists in the CoAP Client acting as Initiator and the CoAP Server acting as Responder. Alternatively, the two roles can be reversed. In the rest of this document, EDHOC messages are considered to be transported over CoAP.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><a href="#fig-non-combined" class="xref">Figure 1</a> shows a Client and Server running EDHOC as Initiator and Responder, respectively. That is, the Client sends a POST request with payload EDHOC message_1 to a reserved resource at the CoAP Server, by default at Uri-Path "/.well-known/edhoc". This triggers the EDHOC exchange at the Server, which replies with a 2.04 (Changed) Response with payload EDHOC message_2. Finally, the Client sends a CoAP POST request to the same resource used for EDHOC message_1, with payload EDHOC message_3. The Content-Format of these CoAP messages may be set to "application/edhoc".<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">After this exchange takes place, and after successful verifications as specified in the EDHOC protocol, the Client and Server can derive an OSCORE Security Context, as defined in <a href="#oscore-ctx" class="xref">Section 4</a> of this document. After that, they can use OSCORE to protect their communications.<a href="#section-2-5" class="pilcrow">¶</a></p>
<span id="name-edhoc-and-oscore-run-sequen"></span><div id="fig-non-combined">
<figure id="figure-1">
        <div class="artwork art-text alignCenter" id="section-2-6.1">
<pre>
   CoAP Client                                  CoAP Server
(EDHOC Initiator)                            (EDHOC Responder)
        | ------------- EDHOC message_1 ------------&gt; |
        |          Header: POST (Code=0.02)           |
        |       Uri-Path: "/.well-known/edhoc"        |
        |      Content-Format: application/edhoc      |
        |                                             |
        | &lt;------------ EDHOC message_2 ------------- |
        |            Header: 2.04 Changed             |
        |      Content-Format: application/edhoc      |
        |                                             |
EDHOC verification                                    |
        |                                             |
        | ------------- EDHOC message_3 ------------&gt; |
        |          Header: POST (Code=0.02)           |
        |        Uri-Path: "/.well-known/edhoc"       |
        |      Content-Format: application/edhoc      |
        |                                             |
        |                                    EDHOC verification
        |                                             +
OSCORE Sec Ctx                                OSCORE Sec Ctx
  Derivation                                     Derivation
        |                                             |
        | ------------- OSCORE Request -------------&gt; |
        |          Header: POST (Code=0.02)           |
        |                                             |
        | &lt;------------ OSCORE Response ------------- |
        |            Header: 2.04 Changed             |
        |                                             |
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-edhoc-and-oscore-run-sequen" class="selfRef">EDHOC and OSCORE run sequentially</a>
        </figcaption></figure>
</div>
<p id="section-2-7">As shown in <a href="#fig-non-combined" class="xref">Figure 1</a>, this purely-sequential way of first running EDHOC and then using OSCORE takes three round trips to complete.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8"><a href="#edhoc-in-oscore" class="xref">Section 5</a> defines an optimization for combining EDHOC with the first subsequent OSCORE transaction. This reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context.<a href="#section-2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-in-coap">
<section id="section-3">
      <h2 id="name-transferring-edhoc-in-coap">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-transferring-edhoc-in-coap" class="section-name selfRef">Transferring EDHOC in CoAP</a>
      </h2>
<p id="section-3-1">When using EDHOC over CoAP for establishing an OSCORE Security Context, EDHOC messages are exchanged as defined in Section 7.2 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, with the following addition.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">EDHOC error messages sent as CoAP responses MUST be error responses, i.e. they MUST specify a CoAP error response code. In particular, it is RECOMMENDED that such error responses have response code either 4.00 (Bad Request) in case of client error (e.g. due to a malformed EDHOC message), or 5.00 (Internal Server Error) in case of server error (e.g. due to failure in deriving EDHOC key material).<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oscore-ctx">
<section id="section-4">
      <h2 id="name-deriving-an-oscore-security">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-deriving-an-oscore-security" class="section-name selfRef">Deriving an OSCORE Security Context from EDHOC</a>
      </h2>
<p id="section-4-1">After successful processing of EDHOC message_3 (see Section 5.5 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>), the Client and Server derive Security Context parameters for OSCORE (see Section 3.2 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>) as follows.<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">The Master Secret and Master Salt are derived by using the EDHOC-Exporter interface defined in Section 4.1 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
<p id="section-4-2.1.2">
The EDHOC Exporter Labels to use are "OSCORE Master Secret" and "OSCORE Master Salt", for deriving the OSCORE Master Secret and the OSCORE Master Salt, respectively.<a href="#section-4-2.1.2" class="pilcrow">¶</a></p>
<p id="section-4-2.1.3">
By default, key_length is the key length (in bytes) of the application AEAD Algorithm of the selected cipher suite for the EDHOC session. Also by default, salt_length has value 8. The Initiator and Responder MAY agree out-of-band on a longer key_length than the default and on a different salt_length.<a href="#section-4-2.1.3" class="pilcrow">¶</a></p>
</li>
      </ul>
<div class="artwork art-text alignLeft" id="section-4-3">
<pre>
   Master Secret = EDHOC-Exporter( "OSCORE Master Secret", key_length )
   Master Salt   = EDHOC-Exporter( "OSCORE Master Salt", salt_length )
</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-4-4.1">The AEAD Algorithm is the application AEAD of the selected cipher suite for the EDHOC session.<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.2">The HKDF Algorithm is the HKDF  algorithm of the selected cipher suite for the EDHOC session.<a href="#section-4-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.3">
          <p id="section-4-4.3.1">In case the Client is the Initiator and the Server is the Responder, the Client's OSCORE Sender ID and the Server's OSCORE Sender ID are the EDHOC connection identifier C_R and C_I for the EDHOC session, respectively. The reverse applies in case the Client is the Responder and the Server is the Initiator.<a href="#section-4-4.3.1" class="pilcrow">¶</a></p>
<p id="section-4-4.3.2">
Before deriving an OSCORE Security Context, the two peers MUST ensure that the EDHOC connection identifiers are different. that is, the two peers MUST NOT derive an OSCORE Security Context from an EDHOC session, if C_R is equal to C_I for that session.<a href="#section-4-4.3.2" class="pilcrow">¶</a></p>
<p id="section-4-4.3.3">
If the Responder runs EDHOC with the intention of deriving an OSCORE Security Context, the Responder MUST NOT include in EDHOC message_2 a connection identifier C_R equal to the connection identifier C_I received in EDHOC message_1. If the Initiator runs EDHOC with the intention of deriving an OSCORE Security Context, the initiator MUST discontinue the protocol and reply with an EDHOC error message when receiving an EDHOC message_2 that includes a connection identifier C_R equal to C_I.<a href="#section-4-4.3.3" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-5">The Client and Server use the parameters above to establish an OSCORE Security Context, as per Section 3.2.1 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">From then on, the Client and Server MUST be able to retrieve the OSCORE protocol state using its chosen connection identifier, and optionally other information such as the 5-tuple, i.e., the tuple (source IP address, source port, destination IP address, destination port, transport protocol).<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-in-oscore">
<section id="section-5">
      <h2 id="name-edhoc-combined-with-oscore">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-edhoc-combined-with-oscore" class="section-name selfRef">EDHOC Combined with OSCORE</a>
      </h2>
<p id="section-5-1">This section defines an optimization for combining the EDHOC exchange with the first subsequent OSCORE transaction, thus minimizing the number of round trips between the two peers.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This approach can be used only if the default EDHOC message flow is used, i.e., when the Client acts as Initiator and the Server acts as Responder, while it cannot be used in the case with reversed roles.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">When running the purely-sequential flow of <a href="#overview" class="xref">Section 2</a>, the Client has all the information to derive the OSCORE Security Context already after receiving EDHOC message_2 and before sending EDHOC message_3.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Hence, the Client can potentially send both EDHOC message_3 and the subsequent OSCORE Request at the same time. On a semantic level, this requires sending two REST requests at once, as in <a href="#fig-combined" class="xref">Figure 2</a>.<a href="#section-5-4" class="pilcrow">¶</a></p>
<span id="name-edhoc-and-oscore-combined"></span><div id="fig-combined">
<figure id="figure-2">
        <div class="artwork art-text alignCenter" id="section-5-5.1">
<pre>
   CoAP Client                                  CoAP Server
(EDHOC Initiator)                            (EDHOC Responder)
        | ------------- EDHOC message_1 ------------&gt; |
        |          Header: POST (Code=0.02)           |
        |       Uri-Path: "/.well-known/edhoc"        |
        |      Content-Format: application/edhoc      |
        |                                             |
        | &lt;------------ EDHOC message_2 ------------- |
        |            Header: 2.04 Changed             |
        |      Content-Format: application/edhoc      |
        |                                             |
EDHOC verification                                    |
        +                                             |
  OSCORE Sec Ctx                                      |
    Derivation                                        |
        |                                             |
        | ---- EDHOC message_3 + OSCORE Request ----&gt; |
        |          Header: POST (Code=0.02)           |
        |                                             |
        |                                    EDHOC verification
        |                                             +
        |                                     OSCORE Sec Ctx
        |                                        Derivation
        |                                             |
        | &lt;------------ OSCORE Response ------------- |
        |            Header: 2.04 Changed             |
        |                                             |
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-edhoc-and-oscore-combined" class="selfRef">EDHOC and OSCORE combined</a>
        </figcaption></figure>
</div>
<p id="section-5-6">To this end, the specific approach defined in this section consists of sending EDHOC message_3 inside an OSCORE protected CoAP message.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">The resulting EDHOC + OSCORE request is in practice the OSCORE Request from <a href="#fig-non-combined" class="xref">Figure 1</a>, as still sent to a protected resource and with the correct CoAP method and options, but with the addition that it also transports EDHOC message_3.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">As EDHOC message_3 may be too large to be included in a CoAP Option, e.g., if containing a large public key certificate chain, it has to be transported in the CoAP payload of the EDHOC + OSCORE request.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">The rest of this section specifies how to transport the data in the EDHOC + OSCORE request and their processing order. In particular, the use of this approach is explicitly signalled by including an EDHOC Option (see <a href="#edhoc-option" class="xref">Section 5.1</a>) in the EDHOC + OSCORE request. The processing of the EDHOC + OSCORE request is specified in <a href="#client-processing" class="xref">Section 5.2</a> for the Client side and in <a href="#server-processing" class="xref">Section 5.3</a> for the Server side.<a href="#section-5-9" class="pilcrow">¶</a></p>
<div id="edhoc-option">
<section id="section-5.1">
        <h3 id="name-edhoc-option">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-edhoc-option" class="section-name selfRef">EDHOC Option</a>
        </h3>
<p id="section-5.1-1">This section defines the EDHOC Option. The option is used in a CoAP request, to signal that the request payload conveys both an EDHOC message_3 and OSCORE protected data, combined together.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The EDHOC Option has the properties summarized in <a href="#fig-edhoc-option" class="xref">Figure 3</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. The option is Critical, Safe-to-Forward, and part of the Cache-Key. The option MUST occur at most once and is always empty. If any value is sent, the value is simply ignored. The option is intended only for CoAP requests and is of Class U for OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<span id="name-the-edhoc-option"></span><div id="fig-edhoc-option">
<figure id="figure-3">
          <div class="artwork art-text alignCenter" id="section-5.1-3.1">
<pre>
+-------+---+---+---+---+-------+--------+--------+---------+
| No.   | C | U | N | R | Name  | Format | Length | Default |
+-------+---+---+---+---+-------+--------+--------+---------+
| TBD21 | x |   |   |   | EDHOC | Empty  |   0    | (none)  |
+-------+---+---+---+---+-------+--------+--------+---------+
       C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-the-edhoc-option" class="selfRef">The EDHOC Option.</a>
          </figcaption></figure>
</div>
<p id="section-5.1-4">The presence of this option means that the message payload contains also EDHOC data, that must be extracted and processed as defined in <a href="#server-processing" class="xref">Section 5.3</a>, before the rest of the message can be processed.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5"><a href="#fig-edhoc-opt" class="xref">Figure 4</a> shows the format of a CoAP message containing both the EDHOC data and the OSCORE ciphertext, using the newly defined EDHOC option for signalling.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<span id="name-coap-message-for-edhoc-and-"></span><div id="fig-edhoc-opt">
<figure id="figure-4">
          <div class="artwork art-text alignCenter" id="section-5.1-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Ver| T |  TKL  |      Code     |          Message ID           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Token (if any, TKL bytes) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  OSCORE option  |   EDHOC option  | other options (if any) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1 1 1 1 1 1 1 1|    Payload
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-coap-message-for-edhoc-and-" class="selfRef">CoAP message for EDHOC and OSCORE combined - signalled with the EDHOC Option</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="client-processing">
<section id="section-5.2">
        <h3 id="name-client-processing">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-client-processing" class="section-name selfRef">Client Processing</a>
        </h3>
<p id="section-5.2-1">The Client prepares an EDHOC + OSCORE request as follows.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-2">
<li id="section-5.2-2.1">
            <p id="section-5.2-2.1.1">Compose EDHOC message_3 as per Section 5.4.2 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-5.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.1.2">
Since the Client is the EDHOC Initiator and the used Correlation Method is 1 (see Section 3.2.4 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>), the EDHOC message_3 always includes the Connection Identifier C_R and CIPHERTEXT_3. Note that C_R is the OSCORE Sender ID of the Client, encoded as a bstr_identifier (see Section 5.1 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>).<a href="#section-5.2-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">Encrypt the original CoAP request as per Section 8.1 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>, using the new OSCORE Security Context established after receiving EDHOC message_2.<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.2.2">
Note that the OSCORE ciphertext is not computed over EDHOC message_3, which is not protected by OSCORE. That is, the result of this step is the OSCORE Request as in <a href="#fig-non-combined" class="xref">Figure 1</a>.<a href="#section-5.2-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-2.3">
            <p id="section-5.2-2.3.1">Build a CBOR sequence <span>[<a href="#RFC8742" class="xref">RFC8742</a>]</span> composed of two CBOR byte strings in the following order.<a href="#section-5.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.3.2.1">The first CBOR byte string is the CIPHERTEXT_3 of the EDHOC message_3 resulting from step 3.<a href="#section-5.2-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2-2.3.2.2">The second CBOR byte string has as value the OSCORE ciphertext of the OSCORE protected CoAP request resulting from step 2.<a href="#section-5.2-2.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-5.2-2.4">Compose the EDHOC + OSCORE request, as the OSCORE protected CoAP request resulting from step 2, where the payload is replaced with the CBOR sequence built at step 3.<a href="#section-5.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.5">Signal the usage of this approach within the EDHOC + OSCORE request, by including the new EDHOC Option defined in <a href="#edhoc-option" class="xref">Section 5.1</a>.<a href="#section-5.2-2.5" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="server-processing">
<section id="section-5.3">
        <h3 id="name-server-processing">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-server-processing" class="section-name selfRef">Server Processing</a>
        </h3>
<p id="section-5.3-1">When receiving a request containing the EDHOC option, i.e. an EDHOC + OSCORE request, the Server MUST perform the following steps.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-2">
<li id="section-5.3-2.1">Check that the payload of the EDHOC + OSCORE request is a CBOR sequence composed of two CBOR byte strings. If this is not the case, the Server MUST stop processing the request and MUST respond with a 4.00 (Bad Request) error message.<a href="#section-5.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.2">Extract CIPHERTEXT_3 from the payload of the EDHOC + OSCORE request, as the first CBOR byte string in the CBOR sequence.<a href="#section-5.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.3">
            <p id="section-5.3-2.3.1">Rebuild EDHOC message_3, as a CBOR sequence composed of two CBOR byte strings in the following order.<a href="#section-5.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.3.2.1">The first CBOR byte string is the 'kid' of the Client indicated in the OSCORE option of the EDHOC + OSCORE request, encoded as a bstr_identifier (see Section 5.1 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>).<a href="#section-5.3-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.3.2.2">The second CBOR byte string is the CIPHERTEXT_3 retrieved at step 2.<a href="#section-5.3-2.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-5.3-2.4">
            <p id="section-5.3-2.4.1">Perform the EDHOC processing on the EDHOC message_3 rebuilt at step 3, including verifications, and the OSCORE Security Context derivation, as per Section 5.4.3 and Section 7.2.1 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>, respectively.<a href="#section-5.3-2.4.1" class="pilcrow">¶</a></p>
<p id="section-5.3-2.4.2">
If the applicability statement used in the EDHOC session specifies that EDHOC message_4 shall be sent, the Server MUST stop the EDHOC processing and consider it failed, as due to a client error.<a href="#section-5.3-2.4.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.5">Extract the OSCORE ciphertext from the payload of the EDHOC + OSCORE request, as the value of the second CBOR byte string in the CBOR sequence.<a href="#section-5.3-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.6">Rebuild the OSCORE protected CoAP request as the EDHOC + OSCORE request, where the payload is replaced with the OSCORE ciphertext resulting from step 5.<a href="#section-5.3-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.7">Decrypt and verify the OSCORE protected CoAP request resulting from step 6, as per Section 8.2 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>, by using the new OSCORE Security Context established at step 4.<a href="#section-5.3-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.8">Process the CoAP request resulting from step 7.<a href="#section-5.3-2.8" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.3-3">If steps 4 (EDHOC processing) and 7 (OSCORE processing) are both successfully completed, the Server MUST reply with an OSCORE protected response, in order for the Client to achieve key confirmation (see Section 5.4.2 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>). The usage of EDHOC message_4 as defined in Section 7.1 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> is not applicable to the approach defined in this specification.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">If step 4 (EDHOC processing) fails, the server discontinues the protocol as per Section 5.4.3 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> and responds with an EDHOC error message, formatted as defined in Section 6.1 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>. In particular, the CoAP response conveying the EDHOC error message MUST have Content-Format set to application/edhoc defined in Section 9.5 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">If step 4 (EDHOC processing) is successfully completed but step 7 (OSCORE processing) fails, the same OSCORE error handling applies as defined in Section 8.2 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example">
<section id="section-5.4">
        <h3 id="name-example-of-edhoc-oscore-req">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-example-of-edhoc-oscore-req" class="section-name selfRef">Example of EDHOC + OSCORE Request</a>
        </h3>
<p id="section-5.4-1"><a href="#fig-edhoc-opt-2" class="xref">Figure 5</a> shows an example of EDHOC + OSCORE Request, based on the OSCORE test vector from Appendix C.4 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and the EDHOC test vector from Appendix B.2 of <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>. In particular, the example assumes that:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-2.1">The used OSCORE Partial IV is 0, consistently with the first request protected with the new OSCORE Security Context.<a href="#section-5.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-2.2">The OSCORE Sender ID of the Client is 0x00. This corresponds to the EDHOC Connection Identifier C_R, which is encoded as the bstr_identifier 0x37 in EDHOC message_3.<a href="#section-5.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-2.3">The EDHOC option is registered with CoAP option number 21.<a href="#section-5.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-example-of-coap-message-wit"></span><div id="fig-edhoc-opt-2">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-5.4-3.1">
<pre>
   o  OSCORE option value: 0x090020 (3 bytes)

   o  EDHOC option value: - (0 bytes)

   o  C_R: 0x37 (1 byte)

   o  CIPHERTEXT_3: 0x52d5535f3147e85f1cfacd9e78abf9e0a81bbf
      (19 bytes)

   o  EDHOC message_3: 0x37 52d5535f3147e85f1cfacd9e78abf9e0a81bbf
      (20 bytes)

   o  OSCORE ciphertext: 0x612f1092f1776f1c1668b3825e (13 bytes)

   From there:

   o  Protected CoAP request (OSCORE message):

      0x44025d1f               ; CoAP 4-byte header
        00003974               ; Token
        39 6c6f63616c686f7374  ; Uri-Host Option: "localhost"
        63 090020              ; OSCORE Option
        C0                     ; EDHOC Option
        ff 52d5535f3147e85f1cfacd9e78abf9e0a81bbf
           4d612f1092f1776f1c1668b3825e
      (57 bytes)
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-coap-message-wit" class="selfRef">Example of CoAP message with EDHOC and OSCORE combined</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">The same security considerations from OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and EDHOC <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span> hold for this document.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">TODO (more considerations)<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">RFC Editor: Please replace "[[this Document]]" with the RFC number of this document and delete this paragraph.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">This document has the following actions for IANA.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="iana-coap-options">
<section id="section-7.1">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-7.1-1">IANA is asked to enter the following option numbers to the "CoAP Option Numbers" registry defined in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> within the "CoRE Parameters" registry.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">[<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">The CoAP option numbers 13 and 21 are both consistent with the properties of the EDHOC Option defined in <a href="#edhoc-option" class="xref">Section 5.1</a>, and they both allow the EDHOC Option to always result in an overall size of 1 byte. This is because:<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.1">The EDHOC option is always empty, i.e. with zero-length value; and<a href="#section-7.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-4.2">Since the OSCORE option with option number 9 is always present in the CoAP request, the EDHOC option would be encoded with a maximum delta of 4 or 12, depending on its option number being 13 or 21.<a href="#section-7.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-5">At the time of writing, the CoAP option numbers 13 and 21 are both unassigned in the "CoAP Option Numbers" registry, as first available and consistent option numbers for the EDHOC option.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">This document suggests 21 (TBD21) as option number to be assigned to the new EDHOC option, since both 13 and 21 are consistent for the use case in question, but different use cases or protocols may make better use of the option number 13.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">]<a href="#section-7.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-7.1-8">
<pre>
+--------+-------+-------------------+
| Number | Name  |     Reference     |
+--------+-------+-------------------+
| TBD21  | EDHOC | [[this document]] |
+--------+-------+-------------------+
</pre><a href="#section-7.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="iana-edhoc-exporter-label">
<section id="section-7.2">
        <h3 id="name-edhoc-exporter-label-regist">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-edhoc-exporter-label-regist" class="section-name selfRef">EDHOC Exporter Label Registry</a>
        </h3>
<p id="section-7.2-1">IANA is asked to enter the following entries to the "EDHOC Exporter Label" registry defined in <span>[<a href="#I-D.ietf-lake-edhoc" class="xref">I-D.ietf-lake-edhoc</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.2-2">
<pre>
Label: OSCORE Master Secret
Description: Derived OSCORE Master Secret
Reference: [[this document]]
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-7.2-3">
<pre>
Label: OSCORE Master Salt
Description: Derived OSCORE Master Salt
Reference: [[this document]]
</pre><a href="#section-7.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-normative-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-lake-edhoc">[I-D.ietf-lake-edhoc]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-edhoc-06</span>, <time datetime="2021-04-21" class="refDate">21 April 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-06.txt">https://datatracker.ietf.org/doc/html/draft-ietf-lake-edhoc-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
      <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc7252">https://datatracker.ietf.org/doc/html/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8174">https://datatracker.ietf.org/doc/html/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8613">https://datatracker.ietf.org/doc/html/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8742">https://datatracker.ietf.org/doc/html/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
    <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8949">https://datatracker.ietf.org/doc/html/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="sec-document-updates">
<section id="section-appendix.a">
      <h2 id="name-document-updates">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="section-appendix.a-1">RFC Editor: Pleare remove this section.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<div id="sec-00-01">
<section id="section-a.1">
        <h2 id="name-version-00-to-01">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.1-1.1">Imported OSCORE-specific content from draft-ietf-lake-edhoc.<a href="#section-a.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.1-1.2">Expanded scope and revised section organization.<a href="#section-a.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.1-1.3">Improved error handling for the combined approach.<a href="#section-a.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.1-1.4">Recommended number for EDHOC option changed to 21.<a href="#section-a.1-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">The authors sincerely thank Christian Amsuess, Klaus Hartke, Jim Schaad and Malisa Vucinic for their feedback and comments in the discussion leading up to this draft.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Hoeglund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stefan Hristozov</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer AISEC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stefan.hristozov@aisec.fraunhofer.de" class="email">stefan.hristozov@aisec.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Goeran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
